spack:
        #  packages:
        #    slurm:
        #      buildable: true

  definitions:
  - libraries:
    - adios
    - boost +mpi 
    - hdf5  +hl
    - netcdf-c +mpi +parallel-netcdf
    - parallel-netcdf 
    - parmetis 
    - py-mpi4py 
    - cgal 
      #- petsc +mpi   ^openmpi

  - libraries_gcc:
      #- openmpi +cuda +legacylaunchers +pmi ~gpfs +pmix fabrics=ucx schedulers=slurm
      #^slurm +pmix  ^ucx +cuda+gdrcopy+thread_multiple
      #- openmpi +cuda +legacylaunchers +pmi ~gpfs +pmix fabrics=ucx schedulers=slurm
      #^slurm@2011.8.1 +pmix  ^ucx +cuda+gdrcopy+thread_multiple
      #- openmpi +cuda+legacylaunchers+pmi~gpfs fabrics=ucx schedulers=slurm ^slurm@20.11.8  ^ucx
      #+cuda+gdrcopy+thread_multiple ^pmix@2.2.3
      #- openmpi +cuda+legacylaunchers+pmi~gpfs fabrics=ucx schedulers=slurm ^slurm@20.11.8  ^ucx
      #+cuda+gdrcopy+thread_multiple
    - openmpi
    - netlib-scalapack
    - netlib-lapack 
    - fftw 

  - libraries_intel:
    - intel-oneapi-mpi
    - intel-oneapi-mkl

  - libraries_oneapi:
    - intel-oneapi-mpi
    - intel-oneapi-mkl

  - applications: 
    - plumed@2.7.2
    - gromacs +mpi+openmp+plumed +lapack
    #- cp2k +mpi+elpa+plumed lmax=6 
    - cp2k +mpi+plumed lmax=6 

  - applications_gcc: 
    - nwchem

  - applications_intel: []
    #- namd fftw=mkl ^charmpp  backend=mpi pmi=slurmpmi2  ^slurm@20-11-8-1 +pmix 
    #- namd fftw=mkl -cuda   
  - applications_oneapi: []

  - benchmarks:
    - osu-micro-benchmarks

###########    changes for compilers happens here #############
  - compilers: ['%${COMPILER}']
  - all:
    - $libraries
    - $libraries_${COMPILER_NAME}
    - $applications
    - $applications_${COMPILER_NAME}
    - $benchmarks
###############################################################

  specs:
  - matrix:
    - - $all
    - - $compilers
  view: false
  concretization: together
